{% extends 'base.html' %}
{% load static %}
{% block content %}

    <div class="hero-content">
        <h1>We are a team dedicated to making mental health support accessible to everyone.</h1>
        <a href="{% url 'login' %}" class="btn btn-primary">Get Started</a>
    </div>
</div>

<!-- ABOUT US SECTION -->
 <div id="about" class="about-container">
    <div class="section-title text-center">
        <h2 class="section-title animate_animated animate_fadeInDown" >
            About Us
        </h2>
    <div class="about-slider-wrapper">
        <div class="about-slider" id="aboutSlider">
            <div class="about-card" id="vision">
                <h2>Our Vision</h2>
                <p>To create a world where mental health support is accessible to everyone, empowering individuals to lead fulfilling lives with emotional resilience.</p>
            </div>
            <div class="about-card" id="mission">
                <h2>Our Mission</h2>
                <p>We strive to provide a secure and user-friendly platform that connects individuals with mental health resources, professionals, and self-care tools to enhance their emotional and psychological well-being.</p>
            </div>
            <div class="about-card" id="what-we-do">
                <ul class="features">
                    <li><i class="bi bi-clock"></i> <strong>24/7 Support:</strong> Get assistance anytime, anywhere.</li>
                    <li><i class="bi bi-person"></i> <strong>Personalized Guidance:</strong> Expert recommendations tailored to you.</li>
                    <li><i class="bi bi-heart"></i> <strong>Interactive Tools:</strong> Assessments, journaling, and self-care activities.</li>
                    <li><i class="bi bi-shield"></i> <strong>Secure & Confidential:</strong> Your privacy and safety are our top priorities.</li>
                </ul>
            </div>
            <div class="about-card cta-box" id="join-us">
                <h2>Join Us Today!</h2>
                <p class="join-us">Join <span class="highlight">thousands of users</span> who trust MindCare for their mental well-being.</p>
                <a href="{% url 'login' %}" class="btn-learn-more">Get Started</a>
            </div>
        </div>
    </div>
    <div class="about-navigation">
        <div class="nav-dot" onclick="moveSlider(0)"></div>
        <div class="nav-dot" onclick="moveSlider(1)"></div>
        <div class="nav-dot" onclick="moveSlider(2)"></div>
        <div class="nav-dot" onclick="moveSlider(3)"></div>
    </div>
</div>

<script>
    let currentSlide = 0;
    function moveSlider(slideIndex) {
        const slider = document.getElementById("aboutSlider");
        slider.style.transform = `translateX(-${slideIndex * 100}%)`;
        document.querySelectorAll(".nav-dot").forEach((dot, index) => {
            dot.classList.toggle("active", index === slideIndex);
        });
        currentSlide = slideIndex;
    }
    
    document.querySelectorAll(".nav-dot").forEach((dot, index) => {
        dot.addEventListener("click", () => moveSlider(index));
    });
    
    setInterval(() => {
        currentSlide = (currentSlide + 1) % 4;
        moveSlider(currentSlide);
    }, 5000);
</script>

<!-- FEATURES SECTION -->
<section id="features" class="section features-section bg-light">
    <div class="container">
        <h2>Our Features</h2>
        <div class="row">
            <div class="col-md-4 feature-box">
                <h3>Personalized Mental Health Support</h3>
                <p>MindCare offers personalized strategies based on emotions, lifestyle, and mental wellness goals.</p>
            </div>
            <div class="col-md-4 feature-box">
                <h3>Community-Oriented</h3>
                <p>A supportive community to share experiences and uplift each other.</p>
            </div>
            <div class="col-md-4 feature-box">
                <h3>Interactive & Engaging Content</h3>
                <p>Interactive exercises, thought-provoking prompts, and engaging challenges to enhance mental well-being.</p>
            </div>
        </div>
    </div>
</section>

<!-- PROFESSIONALS SECTION -->
<section id="professionals" class="professionals">
    <div class="container" data-aos="fade-up">
      <div class="section-title">
        <h2>Meet Our Professionals</h2>
        <p>Connect with experienced mental health professionals ready to support you.</p>
      </div>
  
      <div class="row">
        {% for professional in professionals %}
        <div class="col-lg-4 col-md-6 d-flex align-items-stretch">
          <div class="member">
            {% if professional.image %}
              <img src="{{ professional.image.url }}" class="img-fluid" alt="{{ professional.name }}">
            {% else %}
              <img src="{% static 'assets/images/default.png' %}" class="img-fluid" alt="Default Image">
            {% endif %}
  
            <h4><a href="{% url 'professional_detail' professional.id %}">{{ professional.name }}</a></h4>
            <p>{{ professional.specialty }}</p>
  
            {% if user.is_authenticated %}
            <p><strong>Available Slots:</strong></p>
  <ul id="available-slots-{{ professional.id }}">
    {% for slot in professional.available_slots %}
      {% if slot not in professional.booked_slots %}  {# ✅ Hide booked slots #}
        <li><span style="color: green;">{{ slot }}</span></li>
      {% endif %}
    {% empty %}
      <p class="text-muted">No available slots</p>
    {% endfor %}
  </ul>
  
  <button class="btn btn-primary book-appointment-btn" 
  data-professional-id="{{ professional.id }}" 
  data-professional-name="{{ professional.name }}" 
  data-specialty="{{ professional.specialty }}"
  data-available-slots="{{ professional.available_slots|join:',' }}"
  data-booked-slots="{{ professional.booked_slots|join:',' }}">  <!-- ✅ Add booked slots -->
  Book Appointment
  </button>
  
            {% endif %}
          </div>
        </div>
        {% empty %}
        <p class="text-center">No professionals available at the moment.</p>
        {% endfor %}
      </div>
    </div>
  </section>
  
  <!-- Appointment Booking Modal -->
  <div id="appointment-modal" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Book Appointment</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="appointment-form">
            {% csrf_token %}
            <input type="hidden" name="professional" id="modal-professional-id">
  
            <p>Booking with: <strong id="modal-professional-name"></strong></p>
            <p>Specialty: <span id="modal-specialty"></span></p>
  
            <div class="mb-3">
              <label for="date" class="form-label">Select Date:</label>
              <input type="date" class="form-control" name="date" id="appointment-date" required>
            </div>
  
            <div class="mb-3">
              <label for="time" class="form-label">Select Time:</label>
              <select class="form-select" name="time" id="appointment-time" required>
              </select>
            </div>
  
            <div class="mb-3">
              <label for="reason" class="form-label">Reason:</label>
              <textarea class="form-control" name="reason" placeholder="Enter appointment reason" required></textarea>
            </div>
  
            <button type="submit" class="btn btn-primary w-100">Confirm Appointment</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Success Message -->
  <div id="success-popup" style="display: none; background: green; color: white; padding: 15px; position: fixed; top: 20px; right: 20px; border-radius: 5px; z-index: 1000;">
    Appointment confirmed! A Google Meet link has been sent to your email.  
    <br>
    <a id="meet-link" href="#" style="color: yellow; font-weight: bold;" target="_blank"></a>
  </div>

{% endblock %}
